package testcases;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.List;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.Select;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import basefiles.base;
import pageObjects.Linarc_Company_Objects;

public class Linarc_Company extends base {

	public static Logger Log = LogManager.getLogger(base.class.getName());

	@BeforeTest
	public void initialize() throws IOException {
		driver = initializeDriver();
		driver.get(prop.getProperty("linarcURL"));
	}

	@Test
	public void createCompany() throws InterruptedException, IOException {

		Linarc_Company_Objects obj = new Linarc_Company_Objects(driver);

		obj.getuname().sendKeys("globaladmin");
		obj.getpassword().sendKeys("1LinarcTester@");
		obj.getsignin().click();

		obj.getaddCompany().click();
		obj.getcompanyName().sendKeys("Swan Lake");

		Select a = new Select(obj.getyears());
		a.selectByIndex(2);

		// driver.findElement(By.xpath("//select[@id='years-in-operation']"));

		obj.getwebsite().sendKeys("www.swanlake.com");

		obj.getofficeNumber().sendKeys("11523467831");

		WebElement map = obj.getmapLocation();
		map.sendKeys("Mantri Synergy");
		Thread.sleep(2000);
		map.sendKeys(Keys.ARROW_DOWN);
		map.sendKeys(Keys.ENTER);
		obj.getconstructionType().click();

		Select b = new Select(obj.getprimaryBusiness());
		b.selectByIndex(0);
		// driver.findElement(By.xpath("//select[@id='primary']"));// primary business

		WebElement primary = obj.getspl();
		primary.click();
		Thread.sleep(2000);
		obj.getselectSpl().click();

		// driver.findElement(By.xpath("//input[@id='special']")).sendKeys("Design");

		// primary.sendKeys("Design");
		// primary.sendKeys(Keys.ENTER);

		// driver.findElement(By.xpath("//div[@class='multiselect__tags']")); // search
		// or add specialties

		obj.gettasks().click();// adding task categories

		obj.getselTasks().click();
		obj.getblankClick().click();

		obj.getfirstName().sendKeys("Yogesh");// first name
		obj.getlastName().sendKeys("Waran");// last name
		obj.getfirstJob().sendKeys("Owner");// job title
		obj.getfirstNumber().sendKeys("11919561991");// phone // number
		obj.getfirstEmail().sendKeys("yogiboy2@mailinator.com");// email

		obj.getsecondName().sendKeys("Mark");// first name
		obj.getsecondLastName().sendKeys("Waugh");// last name
		obj.getsecondJob().sendKeys("Admin");// job title
		obj.getsecondNumber().sendKeys("11979874891");
		obj.getsecondEmail().sendKeys("mwaugh@mailinator.com");// email

		WebElement state = obj.getlicenseState(); // license state
		state.sendKeys("Wash");
		Thread.sleep(2000);
		state.sendKeys(Keys.ARROW_DOWN);
		state.sendKeys(Keys.ENTER);
		Select c = new Select(obj.getlicenseType());
		c.selectByIndex(1);
		// driver.findElement(By.xpath("//select[@id='licenseType']"));// License type

		obj.getlicenseNumber().sendKeys("14622");// License number
		obj.getlicenseExpiry().click();
		obj.getcalanderNavigate().click();

		obj.getselectDate().click(); // clicking on license
										// expire date
		obj.getsave().click();
		Thread.sleep(10000);

		// driver.findElement(By.xpath("//div[@class='notification-content']")); If any
		// error occurs this will check

		driver.findElement(By.xpath("//a[@class='in-active']")).click();
		Thread.sleep(4000);
		driver.findElement(By.xpath("//label[@class='displayField']")).click();
		Thread.sleep(7000);
		Runtime.getRuntime().exec("C:\\Users\\Yogesh\\Documents\\auto.exe");
		Thread.sleep(10000);

		// driver.findElement(By.xpath("//div[@class='notification-content']")); If any
		// error occurs this will check

		FileInputStream fis = new FileInputStream("D:\\employee.xlsx");

		// load the input stream to a workbook object
		// Use XSSF for (.xlsx) excel file and HSSF for (.xls) excel file
		XSSFWorkbook wb = new XSSFWorkbook(fis);

		// get the sheet from the workbook by index
		XSSFSheet sheet = wb.getSheet("Sheet1");

		// Count the total number of rows present in the sheet
		int rowcount = sheet.getLastRowNum();
		System.out.println(" Total number of rows present in the sheet : " + rowcount);

		// get column count present in the sheet
		int colcount = sheet.getRow(1).getLastCellNum();
		System.out.println(" Total number of columns present in the sheet : " + colcount);
		
		
		List<WebElement> ele=driver.findElements(By.xpath("//*[@id='choose-accessLevel']"));

		// get the data from sheet by iterating through cells
		for (int i = 1; i <=rowcount; i++) {

			
			String str=sheet.getRow(i).getCell(6).getStringCellValue();
			
			Select s= new Select(ele.get(i-1));
			
			s.selectByVisibleText(str);
			
		}
		
		driver.findElement(By.xpath("//button[@class='import']")).click();
		Thread.sleep(10000);
		
		driver.findElement(By.xpath("//input[@class='selection']")).click();
		Thread.sleep(5000);
		driver.findElement(By.xpath("//button[@class='activate']")).click();
	
		fis.close();
		wb.close();
	}


}
